<!-- CptS 489, Spring 2019
     Project: Task Tracker
     File: app.html
     This file is the start of our 489 project
-->

<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Import External stylesheets and libraries using 'CDN' (content delivery network) links: -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
        integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="../css/app.css">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous">
    </script>

</head>

<style>
    /* Include CSS here */
</style>

<body>
    <nav class="nav bg-primary" id="navbar"></nav>

    <div id="tasks" class="container">
        <br />
        <h1>View and edit a task</h1>

        <div class="card task">
            <div class="card-header">
                <span>
                    <h2 class="far fa-square" id="taskCheckBox" style="display: inline">&nbsp;</h2>
                    <input class="form-control task-title" id="taskHeader" type="text" value="Task title goes here"
                        style="border-color: white; width: 85%;"></input>
                </span>
            </div>
            <div class="card-body">
                <form class="subtask-list">
                    <div class="form-inline">
                        <span class="far fa-square subtask-checkbox" id="checkbox1"></span>
                        <input class="form-control task-textbox" id="textbox1" style="width: 90%" type="text"
                            value="This is an example subtask"></input>
                    </div>
                    <div class="form-inline">
                        <span class="far fa-square subtask-checkbox" id="checkbox2"></span>
                        <input class="form-control task-textbox" id="textbox2" style="width: 90%" type="text"
                            value="This is another example subtask"></input>
                    </div>
                    <div class="form-inline">
                        <span class="far fa-square subtask-checkbox" id="checkbox3"></span>
                        <input class="form-control task-textbox empty-task" id="textbox3" style="width: 90%"
                            type="text"></input>
                    </div>
                </form>
            </div>
            <div class="card-footer">
                <span>
                    <p class="due-date">
                        Due date: <input type="date" id="datepicker"></input>
                    </p>
                </span>
            </div>
        </div>
    </div>
</body>

<script>
    //load the navbar when the page loads
    $(document).ready(function () {
        $("#navbar").load("navbar.html");
    })

    // Event handler for when the enter key is pressed on one of the text input forms.
    // Adds a new empty row for the task to allow the user to input another task
    $(document.body).on("keydown", ".empty-task", function (e) {
        if (e.which == 13 && $(".empty-task").val() != "") { //if the enter key is pressed.
            console.log($(".empty-task").attr("id").match(/\d+/)[0]);
            var curId = parseInt($(".empty-task").attr("id").match(/\d+/)[0]) +
                1; //regex to find only the number at the end of the id
            $(".empty-task").removeClass("empty-task"); //first remove the empty-task class from the old task

            $(".task").children(".card-body").children(".subtask-list")
                .append( // add a new empty task to the end of the current list
                    "<div class=\"form-inline\"><span class=\"far fa-square subtask-checkbox\" id=\"checkbox" +
                    curId +
                    "\"></span>" +
                    "<input class=\"form-control task\-textbox empty-task\" id=\"textbox" + curId +
                    "\"type=\"text\" style=\"width: 90%\"></input></div>"
                );
            return false;
        }
    });

    //toggles the checkboxes when a user clicks them
    $(document.body).on("click", ".subtask-checkbox", function (e) {
        this.classList.toggle("fa-square");
        this.classList.toggle("fa-check-square");
    });

    //need to check a or uncheck all the subtasks
    $("#taskCheckBox").click(function () {
        this.classList.toggle("fa-square");
        this.classList.toggle("fa-check-square");
        $(".subtask-checkbox").toggleClass("fa-check-square", "fa-square");
        $(".subtask-checkbox").toggleClass("fa-square", "fa-check-square");
    })
</script>

</html>